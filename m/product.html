<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0"/>
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <title>传智云购-搜索中心</title>
    <link type="image/x-icon" rel="shortcut icon" href="images/favicon.ico">
    <link rel="stylesheet" href="res/mui/css/mui.min.css"/>
    <link rel="stylesheet" href="res/fontAwesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="css/common.css"/>
    <link rel="stylesheet" href="css/product.css"/>
</head>
<body>
<div class="cz_layout">
    <header class="cz_topBar">
        <a href="javascript:history.back();" class="icon_back fa fa-arrow-left"></a>
        <span class="title">商品详情</span>
        <a href="index.html" class="icon_home fa fa-home"></a>
    </header>
    <div class="cz_container ">
        <div class="mui-scroll-wrapper">
            <div class="mui-scroll" id="detail">
                
            </div>
        </div>
    </div>
</div>
<div class="p_option">
    <a href="#" class="btn_cart fa fa-shopping-cart"></a>
    <a href="#" class="btn_addCart">加入购物车</a>
    <a href="#" class="btn_pay">立即购买</a>
</div>
<script src="res/mui/js/mui.min.js"></script>
<script src="res/mui/js/mui.lazyload.js"></script>
<script src="res/mui/js/mui.lazyload.img.js"></script>
<script>
    //根据商品的id来获取商品的信息
    //1.获取地址上的商品 id
    var search=location.search.slice(1);

    // 以 & 符号为分隔拆分成数组
    var arr = search.split('&');

    var 0 ={};
    //遍历数据对单元以 = 符号二次拆分
    for(var i=0;i<arr.length;i++) {
        //二次拆分
        var temp=arr[i].split('=');
        o[tmp[0]]==tmp[1];
    }



    //2.发送至服务端

    $.ajax ({
        url:'/api/product/queryProductDetail',
        type:'get',
        data:{
            //地址上解析到的参数 pid
            id:o.pid
        },
        //3.等待结果
        success:function(info) {
            console.log(info)

            //对数据进行处理
            info.dis=(info.price / info.oldPrice * 10).toFixed(1);

            //对型号处理成数组
            info.size = info .size .split('-');

            //调用模版引擎
            var html=template('tpl',info);
            $('#dedatil').html(html);
            mui('.mui-slider').slider({
            interval:3000 //自动轮播周期，若为0则不自动播放，默认为0；
        });
        mui('.mui-scroll-wrapper').scroll({
            scrollY: true, //是否竖向滚动
            scrollX: false, //是否横向滚动
            startX: 0, //初始化时滚动至x
            startY: 0, //初始化时滚动至y
            indicators: false, //是否显示滚动条
            deceleration:0.0006, //阻尼系数,系数越小滑动越灵敏
            bounce: true, //是否启用回弹
        });
        }
    })

    //完成型号.对应的Dom交互
    $('#detail').on ('click',function() {
        $(this).addClass('p_active').siblings().removeClass('p_active');
    } )
    $('#detail').on('click'.function() {
        var input = $(this).siblings('input');
        var n = input.val() - 0;

        if($(this).is('.jia')) {
            if(n >=$('.p_num').text())return;

            //数量修改
            return input.val(++n);
        }
        // 不能小于1
        if(n <= 1) return;
        input.val(--n);
    })
</script>

</body>
</html>